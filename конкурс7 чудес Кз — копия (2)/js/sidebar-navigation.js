// Данные о чудесах для навигации
const wondersData = [
    {
        name: "Аккум-Калкан",
        index: 6,
        description: "Аккум-Калкан (часто называют Поющий бархан) — крупная песчаная дюна на территории Государственного национального парка «Алтын-Эмель» в Алматинской области Казахстана, на правом берегу реки Или, между хребтами Большой и Малый Калкан. Дюна достигает около 150 м в высоту, почти 3 км в длину и около 3 км в ширину, причём она заметно выделяется среди окружающей каменистой пустыни, поросшей саксаулом и кустарником. Эта песчаная гора стационарна — в отличие от типичных барханов в пустыне она не «перемещается» под действием ветра.",
        coordinates: "43.8660, 78.5630"
    },
    {
        name: "Чарынский каньон",
        index: 5,
        description: "Чарынский каньон — крупный природный каньон на реке Чарын в Алматинской области Казахстана, примерно в 195–200 км к востоку от Алматы и недалеко от границы с Китаем. Он протянулся вдоль реки примерно 154 км, при этом глубина каньона достигает 150–300 м в разных участках. Скальные стенки сложены из разноцветных осадочных пород — преимущественно красного песчаника — которые эрозия сформировала в причудливые формы и колонны. Наиболее узнаваемая часть каньона называется «Долина Замков» из-за сходства отдельных выступов с башнями и крепостными стенами.",
        coordinates: "43.353139, 79.071393"
    },
    {
        name: "Кольсайские озёра",
        index: 4,
        description: "Это система из трёх высокогорных озёр в северном Тянь-Шане на территории Алматинской области Казахстана, в ущелье реки Кольсай. Озёра расположены каскадом на разных высотах: Нижнее (~1800 м над уровнем моря), Среднее (~2250 м) и Верхнее (~2800 м). Вода в них отличается невероятной чистотой и меняет оттенки от лазурного до изумрудного в зависимости от освещения. Озёра окружены густыми хвойными лесами, крутыми склонами и альпийскими лугами, что создаёт впечатление «жемчужины Северного Тянь-Шаня». Их часто называют «Казахской Швейцарией» из-за живописных горных пейзажей.",
        coordinates: "42.9837, 78.3241"
    },
    {
        name: "Озеро Каинды",
        index: 3,
        description: "Озеро Каинды — уникальный высокогорный водоём в Алматинской области Казахстана, на северном склоне Кунгей-Ала-Тоo в системе Тянь-Шаня, на высоте примерно 1900–2000 м над уровнем моря. Вода в озере отличается кристальной чистотой и насыщенным голубовато-зелёным цветом, что объясняется минералами и родниковой водой. Главная особенность озера — «затопленный лес»: стволы хвойных деревьев (в основном ели) поднимаются прямо из воды словно мачты затонувших кораблей, сохранившиеся благодаря низкой температуре озёрной воды (в летний период не превышает около +6 °C).",
        coordinates: "42.98443, 78.46577"
    },
    {
        name: "Урочище Бектау-Ата",
        index: 2,
        description: "Урочище Бектау-Ата — природный гранитный массив в Карагандинской области Казахстана, примерно в 70 км к северу от города Балхаш в Актогайском районе. Это холмистая гористая местность площадью около 4000 га, выделяющаяся среди окружающей степи за счёт причудливых скальных форм, каньонов и маленьких лесков. Главная вершина высотой около 1214 м над уровнем моря, а в составе массива есть другие отдельные массивы с собственными названиями. Скалы сформированы из розового гранита — древнего магматического тела, поднявшегося на поверхность и выветренного ветром и водой в фантастические формы, такие как «гриб», «черепаха» и «трезубец».",
        coordinates: "47.4511, 74.7760"
    },
    {
        name: "Шайтанколь",
        index: 1,
        description: "Озеро Шайтанколь (в переводе с казахского «Чертово озеро») расположено в Карагандинской области, примерно в 5 км к западу от города Каркаралинск, на территории Каркаралинского государственного национального природного парка. Оно находится на высоте около 1200 м над уровнем моря и окружено крутыми гранитными скалами и сосновым лесом. Размеры озера невелики: длина около 60 м, ширина около 40 м, средняя глубина около 2 м, а вода в нём считается кристально чистой. Озеро питается талой и дождевой водой; туда не впадают видимые ручьи, и оно не пересыхает в жаркий период благодаря растительности по берегам, которая уменьшает испарение.",
        coordinates: "49.3967, 75.3936"
    },
    {
        name: "Урочище Босжира",
        index: 0,
        description: "Урочище Босжыра расположено на западной окраине плато Устюрт в Мангистауской области Казахстана. Это обширная долина с белыми меловыми обрывами, останцами и гребнями, резко возвышающимися над плоской степью. Ландшафт выглядит пустынным и «внеземным»: слоистые скалы, острые пики и плато почти лишены растительности. В разное время суток меловые поверхности меняют цвет — от холодно-белого до тёплого золотистого на закате.",
        coordinates: "43.415548, 54.073469"
    }
];

// Создание всплывающего окна с описанием
// альтернативный способ не делать одного и того же для всех страниц
function createPopup() {
    const popup = document.createElement('div');
    popup.id = 'description-popup';
    popup.className = 'popup-container';
    popup.innerHTML = `
        <div class="popup-paper">
            <button class="popup-close">✕</button>
            <div class="popup-content">
                <h2 id="popup-title"></h2>
                <p id="popup-description"></p>
            </div>
        </div>
    `;
    document.body.appendChild(popup);
    return popup;
}

// Показать всплывающее окно
function showPopup(wonderData) {
    let popup = document.getElementById('description-popup');
    if (!popup) {
        popup = createPopup();
        
        // Закрытие по клику на крестик
        const closeBtn = popup.querySelector('.popup-close');
        closeBtn.addEventListener('click', hidePopup);
        
        // Закрытие по клику вне окна
        popup.addEventListener('click', (e) => {
            if (e.target === popup) {
                hidePopup();
            }
        });
    }
    
    // контент
    document.getElementById('popup-title').textContent = wonderData.name;
    document.getElementById('popup-description').textContent = wonderData.description;
    
    // Анимка
    popup.classList.add('popup-visible');
}

// Скрыть всплывающее окно
function hidePopup() {
    const popup = document.getElementById('description-popup');
    if (popup) {
        popup.classList.remove('popup-visible');
    }
}

// Открыть карту в новой вкладке
function openMap(coordinates) {
    const mapUrl = `https://www.google.com/maps?q=${coordinates}&z=12`;
    window.open(mapUrl, '_blank');
}

// Перейти на страницу с подробностями
function goToDetails(wonderIndex) {
    window.location.href = `detals.html?wonder=${wonderIndex}`;
}

// Инициализация навигации в сайдбаре
function initializeSidebarNavigation() {
    const sidebar = document.getElementById('sidebar');
    if (!sidebar) return;
    
    const detailsElements = sidebar.querySelectorAll('details');
    
    detailsElements.forEach((details, index) => {
        if (index >= wondersData.length) return;
        
        const wonderData = wondersData[index];
        const listItems = details.querySelectorAll('li');
        
        // Карта
        if (listItems[0]) {
            listItems[0].style.cursor = 'pointer';
            listItems[0].addEventListener('click', (e) => {
                e.stopPropagation();
                openMap(wonderData.coordinates);
            });
        }
        
        // Краткое описание
        if (listItems[1]) {
            listItems[1].style.cursor = 'pointer';
            listItems[1].addEventListener('click', (e) => {
                e.stopPropagation();
                showPopup(wonderData);
            });
        }
        
        // Подробности
        if (listItems[2]) {
            listItems[2].style.cursor = 'pointer';
            listItems[2].addEventListener('click', (e) => {
                e.stopPropagation();
                goToDetails(wonderData.index);
            });
        }
    });
}

// Инициализация при загрузке страницы, иначе полетит
window.onload = initializeSidebarNavigation;